# 영화 시놉시스 다중 감정 분석 및 사용자 감정 기반 영화 추천 시스템

## 프로젝트 개요
**자연어 처리(NLP)** 및 **감정 분석 모델**을 활용하여  
사용자의 입력된 문장에서 감정 분석 후 해당 감정에 적합한 영화를 추천하는 **AI 기반 감정 맞춤형 영화 추천 시스템**

---

## 사용 기술 및 라이브러리
- **Python**, **PyTorch**
- **Hugging Face Transformers**, **KoBERT (한국어 BERT)**
- **NLTK**, **GluonNLP**
- **scikit-learn**, **Pandas**, **NumPy**
- **Google Colab 환경에서 실행**

---

## 데이터셋
1. **감정 분석 학습 데이터 (chat_data.xlsx)**
   - 한국어 문장과 이에 대응하는 감정 레이블(공포, 놀람, 분노, 슬픔, 중립, 행복, 혐오)  
   - 총 **38,594개** 문장 데이터 사용  
   
2. **영화 추천 데이터 (movie.xlsx)**
   - 감정별로 추천할 수 있는 영화 목록 (제목, 줄거리, 감정 레이블 포함)

---

## 모델 구성 및 학습 과정

### **감정 분석 모델 (KoBERT 기반)**
- **KoBERT**를 활용한 감정 분석 모델 학습  
- 문장을 토큰화하여 BERT 임베딩 후, 분류 레이어를 거쳐 감정을 예측  

- **모델 성능 (Accuracy)**
  - Train Accuracy: **80.49%**
  - Test Accuracy: **55.81%**
  
---

## 영화 추천 시스템

### **1. 감정 분석 과정**
1. 사용자가 입력한 문장을 **KoBERT 감정 분석 모델**에 입력
2. 모델이 7가지 감정 중 **가장 높은 확률을 가진 감정**을 예측
3. 감정별 확률을 출력하여 사용자가 확인할 수 있도록 제공

### **2. 감정 기반 영화 추천 과정**
1. 감정 분석 결과에 따라 미리 준비된 영화 데이터에서 감정과 일치하는 영화 필터링
2. 필터링된 영화 중 **랜덤 샘플링을 통해 3편 추천**
3. 추천된 영화의 **제목과 시놉시스(줄거리)**를 사용자에게 출력

---

## 예제 실행 결과

### **사용자 입력 예시 **
**입력 문장:**  
> "오늘 날씨 너무 좋다!"

**감정 분석 결과:**  
> 공포: 0.04% 놀람: 0.19% 분노: 0.08% 슬픔: 0.11% 중립: 0.14% 행복: 99.40% 혐오: 0.04%

> **→ 입력하신 내용에서 "행복"의 감정이 가장 높습니다.**

> **"행복" 감정에 어울리는 추천 영화:**  
> 1. **건축학개론** - 건축학과 학생 승민과 서연의 첫사랑 이야기  
> 2. **극한직업** - 위장 창업한 형사들의 코미디 액션  
> 3. **럭키** - 킬러와 무명 배우의 인생 뒤바뀜 이야기

---

## 영화 추천 시스템 개선
   - 현재 영화 추천 시스템은 영화의 줄거리(시놉시스)에 포함된 감정을 기준으로 추천하고 있음  
   - 하지만 **영화가 전달하는 감정은 단순히 줄거리에서 오는 것이 아니라, 연출, 배우의 연기, 음악, 서사적 맥락 등에 따라 다르게 느껴질 수 있음**  
   - 이를 해결하기 위해 **사용자 리뷰 데이터, 영화 장르, 감정 변화 패턴 등을 추가적으로 고려한 추천 시스템 개발** 필요  
